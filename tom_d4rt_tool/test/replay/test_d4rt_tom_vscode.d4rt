# D4rt Test Suite - Tom VS Code Scripting API Classes
# Run with: d4rt test_d4rt_tom_vscode.d4rt -test
# Tests tom_vscode_scripting_api bridged classes
# NOTE: Uses single-line syntax for D4rt parser compatibility


# =============================================================================
# Test: VSCodeBridgeResult (requires success and duration)
# =============================================================================

var result = VSCodeBridgeResult(success: true, value: 'test', duration: Duration(milliseconds: 100));
verifyNotNull(result, 'VSCodeBridgeResult created');
verifyEquals(result.success, true, 'Result success');
verifyEquals(result.value, 'test', 'Result value');
verifyNotNull(result.duration, 'Result duration');

var errorResult = VSCodeBridgeResult.failure(error: 'Connection failed', duration: Duration(milliseconds: 50));
verifyEquals(errorResult.success, false, 'Error result success is false');
verifyEquals(errorResult.error, 'Connection failed', 'Error message');

var successResult = VSCodeBridgeResult.success(value: 'OK', duration: Duration(milliseconds: 25));
verifyEquals(successResult.success, true, 'Success result is true');
verifyEquals(successResult.value, 'OK', 'Success value');

# =============================================================================
# Test: DiagnosticSeverity Enum
# =============================================================================

verifyNotNull(DiagnosticSeverity.error, 'DiagnosticSeverity.error');
verifyNotNull(DiagnosticSeverity.warning, 'DiagnosticSeverity.warning');
verifyNotNull(DiagnosticSeverity.information, 'DiagnosticSeverity.information');
verifyNotNull(DiagnosticSeverity.hint, 'DiagnosticSeverity.hint');

# =============================================================================
# Test: LanguageModelChatMessage
# =============================================================================

var userMsg = LanguageModelChatMessage.user('Hello, how are you?');
verifyNotNull(userMsg, 'User message created');

var assistantMsg = LanguageModelChatMessage.assistant('I am doing well!');
verifyNotNull(assistantMsg, 'Assistant message created');

# =============================================================================
# Test: Position (positional args: line, character)
# =============================================================================

var pos = Position(10, 5);
verifyNotNull(pos, 'Position created');
verifyEquals(pos.line, 10, 'Position line');
verifyEquals(pos.character, 5, 'Position character');

# =============================================================================
# Test: Range (positional args: start, end)
# =============================================================================

var startPos = Position(10, 5);
var endPos = Position(10, 20);
var range = Range(startPos, endPos);
verifyNotNull(range, 'Range created');
verifyNotNull(range.start, 'Range start');
verifyNotNull(range.end, 'Range end');

# =============================================================================
# Test: Selection (positional args: anchor, active, isReversed)
# =============================================================================

var anchor = Position(5, 0);
var active = Position(10, 15);
var selection = Selection(anchor, active, false);
verifyNotNull(selection, 'Selection created');
verifyNotNull(selection.anchor, 'Selection anchor');
verifyNotNull(selection.active, 'Selection active');
verifyEquals(selection.isReversed, false, 'Selection isReversed');

# =============================================================================
# Test: Classes Exist
# =============================================================================

verifyNotNull(VSCodeBridgeResult, 'VSCodeBridgeResult class exists');
verifyNotNull(Extension, 'Extension class exists');
verifyNotNull(ChatParticipant, 'ChatParticipant class exists');
verifyNotNull(ChatRequest, 'ChatRequest class exists');
verifyNotNull(ChatContext, 'ChatContext class exists');
verifyNotNull(ChatResult, 'ChatResult class exists');
verifyNotNull(VSCodeCommands, 'VSCodeCommands class exists');

# =============================================================================
# Summary
# =============================================================================

testSummary();
