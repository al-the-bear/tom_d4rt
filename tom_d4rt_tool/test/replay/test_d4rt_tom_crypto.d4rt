# D4rt Test Suite - Tom Crypto Classes
# Run with: d4rt test_d4rt_tom_crypto.d4rt -test
# Tests tom_crypto bridged classes


# =============================================================================
# Test: TomPasswordHasher Static Methods (8 tests)
# =============================================================================

# TomPasswordHasher is a static utility class - no constructor
verifyNotNull(TomPasswordHasher, 'TomPasswordHasher class exists');

# Hash a password using static method
var password = 'test_password_123';
var hashResult = TomPasswordHasher.hashPassword(password);
verifyNotNull(hashResult, 'Password hash created');

# Generate salt
var salt = TomPasswordHasher.generateSalt(16);
verifyNotNull(salt, 'Salt generated');

# Check static getters
var defaultSaltLength = TomPasswordHasher.globalSettingDefaultSaltLength;
verifyNotNull(defaultSaltLength, 'Default salt length setting');

var defaultHashSpec = TomPasswordHasher.globalSettingDefaultHashSpec;
verifyNotNull(defaultHashSpec, 'Default hash spec setting');

# =============================================================================
# Test: TomJwtTokenException (4 tests)
# =============================================================================

var jwtEx = TomJwtTokenException('JWT_INVALID', 'Token is invalid');
verifyNotNull(jwtEx, 'TomJwtTokenException created');
verifyEquals(jwtEx.key, 'JWT_INVALID', 'JwtException key');
verifyEquals(jwtEx.defaultUserMessage, 'Token is invalid', 'JwtException message');

# =============================================================================
# Test: Classes Exist (4 tests)
# =============================================================================

verifyNotNull(TomJwtConfiguration, 'TomJwtConfiguration class exists');
verifyNotNull(TomServerJwtToken, 'TomServerJwtToken class exists');
verifyNotNull(TomClientJwtToken, 'TomClientJwtToken class exists');
verifyNotNull(RsaKeyHelper, 'RsaKeyHelper class exists');

# =============================================================================
# Test: Global Variables (2 tests)
# =============================================================================

verifyNotNull(tomRsaHashIdentifier, 'tomRsaHashIdentifier global');

# =============================================================================
# Summary
# =============================================================================

testSummary();
