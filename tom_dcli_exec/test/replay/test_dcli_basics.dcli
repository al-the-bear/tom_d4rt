# DCli Basic Functionality Tests
# Run with: dcli -run-replay test_dcli_basics.dcli -test
# Or: dart run bin/dcli.dart -run-replay test/replay/test_dcli_basics.dcli -test

# =============================================================================
# Test: Basic Types and Expressions
# =============================================================================

var x = 10;
verify(x == 10, 'Variable assignment should work');

var greeting = 'Hello, DCli!';
verifyContains(greeting, 'DCli', 'String should contain DCli');

var numbers = [1, 2, 3, 4, 5];
verifyEquals(numbers.length, 5, 'List should have 5 elements');
verifyNotEmpty(numbers, 'Numbers list should not be empty');

# =============================================================================
# Test: Basic Arithmetic
# =============================================================================

var sum = 10 + 20;
verifyEquals(sum, 30, '10 + 20 should equal 30');

var product = 5 * 6;
verifyEquals(product, 30, '5 * 6 should equal 30');

var quotient = 100 ~/ 7;
verifyEquals(quotient, 14, '100 ~/ 7 should equal 14');

# =============================================================================
# Test: String Operations
# =============================================================================

var name = 'DCli';
var fullName = 'Hello, $name!';
verifyEquals(fullName, 'Hello, DCli!', 'String interpolation should work');

var upper = name.toUpperCase();
verifyEquals(upper, 'DCLI', 'toUpperCase should work');

var lower = name.toLowerCase();
verifyEquals(lower, 'dcli', 'toLowerCase should work');

# =============================================================================
# Test: List Operations
# =============================================================================

var fruits = ['apple', 'banana', 'cherry'];
verifyEquals(fruits.first, 'apple', 'First element should be apple');
verifyEquals(fruits.last, 'cherry', 'Last element should be cherry');

var mapped = fruits.map((f) => f.toUpperCase()).toList();
verifyEquals(mapped[0], 'APPLE', 'Map should transform elements');

# =============================================================================
# Test: Map Operations
# =============================================================================

var config = {'host': 'localhost', 'port': 8080};
verifyEquals(config['host'], 'localhost', 'Map access should work');
verifyEquals(config['port'], 8080, 'Map numeric values should work');

var keys = config.keys.toList();
verifyLength(keys, 2, 'Map should have 2 keys');

# =============================================================================
# Test: Function Definitions
# =============================================================================

int add(int a, int b) => a + b;
verifyEquals(add(2, 3), 5, 'add(2, 3) should equal 5');
verifyEquals(add(-1, 1), 0, 'add(-1, 1) should equal 0');

String greet(String name) => 'Hello, $name!';
verifyEquals(greet('World'), 'Hello, World!', 'greet function should work');

# =============================================================================
# Test: Control Flow (using List methods instead of for loops)
# =============================================================================

var numbers = [1, 2, 3, 4, 5];
var result = numbers.fold(0, (a, b) => a + b);
verifyEquals(result, 15, 'Sum 1 to 5 should be 15');

var list = [1, 2, 3];
var count = list.fold(0, (a, b) => a + b);
verifyEquals(count, 6, 'List sum should be 6');

# =============================================================================
# Test: Conditional Expressions
# =============================================================================

var age = 25;
var category = age >= 18 ? 'adult' : 'minor';
verifyEquals(category, 'adult', 'Ternary should work');

var nullValue = null;
var defaultValue = nullValue ?? 'default';
verifyEquals(defaultValue, 'default', 'Null coalescing should work');

# =============================================================================
# Summary
# =============================================================================

testSummary();
